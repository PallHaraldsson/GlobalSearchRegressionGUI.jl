{% extends 'default.html' %}

{% block javascripts %}
    {{ super() }}
    <script>
        $('html').bind('keypress', function(e) {
            if(e.keyCode == 13) {
                return false;
            }
        });

        $(document).ready(function() {
            var outsampleInput = '#outsample';
            var criteriaSelect = '#criteria_select';
            
            $(outsampleInput).change(function() {
                var outsampleValue =  parseInt($(outsampleInput).val());
                $(criteriaSelect).find('option[value="rmseout"]').prop('disabled', !(outsampleValue > 0));
                $(criteriaSelect).select2('destroy');
                $(criteriaSelect).select2();
                $(criteriaSelect).trigger("change");
            });
            $(outsampleInput).trigger("change");
        });
    </script>
{% endblock javascripts %}


{% block container %}
    {{ super() }}
    <h2>Step {{ step }}: Settings</h2>

    <form action="Backend.output" id="form" data-bind="true">
        <div class="row">
            <div class="col-md-6">
                <div class="form-group" title="Out of sample observations">
                    <label for="outsample">Test set size (observations)  <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></label>
                    <div class="input-group col-md-12">
                        <input id="outsample" name="outsample" type="number" class="form-control squared border-red col-md-12" value="0" min="0" max="{{ available_outsample }}"
                            data-max-title="Out of sample setting"
                            data-min-title="Out of sample setting"
                            data-max-body="Your selection is higher than expected. It will be redefined at the maximum value ({{ available_outsample }})."
                            data-min-body="Your selection is lower than expected. It will be redefined at the minimum value (0)."
                        />
                    </div>
                    <small>Min: 0 &nbsp;&nbsp;|&nbsp;&nbsp; Max: {{ available_outsample }}</small>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group" title="Rank variable">
                    <label for="criteria_select">Ordering criteria  <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></label>
                    <div class="input-group col-md-12">
                        <select id="criteria_select" multiple="multiple" class="form-control multiselect mbl bg-red text-white squared" data-toggle="select" required>
                            {% for a_criteria in available_criteria %}
                                <option value="{{ a_criteria.name }}">{{ a_criteria.title }}</option> 
                            {% endfor %}
                        </select>
                        <input type="hidden" id="criteria" name="criteria" data-toggle="select4" />
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group" title="Force same sample">
                    <label for="samesample">Force same sample <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></label>
                    <div class="input-group col-md-12">
                        <div class="bootstrap-switch-square">
                            <select id="samesample" name="samesample" class="form-control select mbl bg-red text-white squared" data-toggle="select" required>
                                <option value="on">Yes</option>
                                <option value="off">No</option> 
                            </select>
                        </div>                
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group" title="Number of threads">
                    <label for="threads">Number of threads <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></label>
                    <div class="input-group quantity col-md-12">
                        <input id="threads" name="threads" type="number" class="form-control squared border-red col-md-12" value="{{ cpu_count }}" step="1" min="1" max="{{ cpu_count }}"
                            data-max-title="Threads setting" 
                            data-min-title="Threads setting" 
                            data-max-body="Your selection is higher than expected. It will be redefined at the maximum value ({{ cpu_count }})." 
                            data-min-body="Your selection is lower than expected. It will be redefined at the minimum value (1)." 
                        />
                    </div>
                    <small>Min: 1 &nbsp;&nbsp;|&nbsp;&nbsp; Max: {{ cpu_count }}</small>
                </div>
            </div>
        </div>
        <div class="nav">
            <a href="Backend.back_variables" id="link" data-bind="true" class="btn btn-lg pull-left bg-blue text-white">Back</a>
            <button type="submit" id="next" class="btn btn-lg pull-right bg-green text-white">Next</button>
        </div>
    </form>
{% endblock %}